<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survey</title>

    <!--Bootstrap assistance-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!--Adding style to our page-->
    <link rel="stylesheet" type="text/css" href="survey-style.css">
    <link href='https://fonts.googleapis.com/css?family=Barlow' rel='stylesheet'>
    <link rel="icon" type="image/png" href="../favicon.png">
    <script src="https://kit.fontawesome.com/7af180cc8b.js" crossorigin="anonymous"></script>

    <!--External scripts-->
    <script src="survey-script.js" type="text/javascript"></script>
    <script>
        // Finds all tool tip spots in the code and passes them on to be created
        function setupToolTips() {
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.forEach(createAToolTip);
        }

        // Initializes a tooltip at a marked spot
        function createAToolTip(tooltipTriggerEl) {
            new bootstrap.Tooltip(tooltipTriggerEl);
        }

        // User feedback: closing the modal and refreshing
        function closeModal() {
            if (document.getElementById("submission-notice").style.visibility == "hidden") {
                bootstrap.Modal.getOrCreateInstance(document.getElementById("pop-up")).hide();
                updateSurveyTable();
            }
        }
    </script>

    <!--Authentication-->
    <script src="/_shared/jwt-decode.js"></script>
    <script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>

    <script src="/_shared/auth0-functions.js" type="text/javascript"></script>
    <script src="/_shared/authenticate.js" type="module"></script>

</head>


<body onload="setupModalButton(); setupSurvey(); setupToolTips(); addAdmin();">
    <div class="container-fluid full-width d-flex flex-column min-vh-100">

        <!--Banner-->
        <div class="sticky-top">

            <!--Banner Items-->
            <div class="row align-items-center" style="background-color: white;">
                <div class="col text-start">
                    <h1>Kalamazoo Arboretum Census</h1>
                </div>
                <div class="col text-end">
                    <i class="fas fa-bars" data-bs-toggle="collapse" data-bs-target="#banner" aria-expanded="false"
                        aria-controls="banner" id="to-drop-down-button"></i>

                </div>
            </div>


            <!--Banner drop down menu-->
            <div id="banner" class="collapse container-fluid full-width" style="position: absolute;">

                <div class="row">
                    <div class="col bg-light"></div>
                    <div class="col-auto bg-light">
                        <a href="../survey/" id="banner-drop-option">Survey</a>
                    </div>
                </div>
                <div class="row">
                    <div class="col bg-light"></div>
                    <div class="col-auto bg-light ">
                        <a href="../settings/" id="banner-drop-option">Change Password</a>
                    </div>
                </div>
                <div class="row">
                    <div class="col bg-light"></div>
                    <div class="col-auto bg-light ">
                        <a href="../login/" id="banner-drop-option">Logout</a>
                    </div>
                </div>
            </div>
        </div>




        <!--Survey table popups-->
        <div class="modal fade" id="pop-up" data-bs-backdrop="static" tabindex="-1"
            aria-labelledby="staticBackdropLabel" aria-hidden="true">

            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">

                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">Update & View</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                            onclick="offModalWarning();"></button>
                    </div>


                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-2"></div>
                                <div class="col-1 text-center">
                                    <i class="fas fa-circle-info" style="margin-top: 50%;" data-bs-toggle="tooltip"
                                        data-bs-placement="top" data-bs-title="The identified type of tree."></i>
                                </div>
                                <div class="col-3 text-center">
                                    <h4>
                                        Species</h4>
                                </div>
                                <div class="col-4 text-center" id="give-species">
                                    <h4>Some Tree Name</h4>
                                </div>
                                <div class="col-2"></div>
                            </div>

                            <br>

                            <div class="row">
                                <div class="col-2"></div>
                                <div class="col-1 text-center">
                                    <i class="fas fa-circle-info" data-bs-toggle="tooltip" data-bs-placement="top"
                                        data-bs-title="The last time this tree has been updated across the censuses. Note that this will be automatically changed if you update a tree."></i>
                                </div>
                                <div class="col-3 text-center">
                                    <h4>
                                        Updated</h4>
                                </div>
                                <div class="col-4 text-center">
                                    <h4 id="given-date">2025</h4>
                                </div>
                                <div class="col-2"></div>
                            </div>

                            <br>

                            <div class="row">
                                <div class="col-2"></div>
                                <div class="col-1 text-center">
                                    <i class="fas fa-circle-info" style="margin-top: 50%;" data-bs-toggle="tooltip"
                                        data-bs-placement="top"
                                        data-bs-title="The most recent tag number assigned to this tree. Use -1 to identify to trees with no tag."></i>
                                </div>
                                <div class="col-3 text-center">
                                    <h4>
                                        Tag</h4>
                                </div>
                                <div class="col-4 text-center">
                                    <input type="number" id="given-tag">
                                </div>
                                <div class="col-2"></div>
                            </div>

                            <br>

                            <div class="row">
                                <div class="col-2"></div>
                                <div class="col-1 text-center">
                                    <i class="fas fa-circle-info" style="margin-top: 50%;" data-bs-toggle="tooltip"
                                        data-bs-placement="top"
                                        data-bs-title="Which of the roughly 4 states the tree falls into."></i>
                                </div>
                                <div class="col-3 text-center">
                                    <h4>
                                        Status</h4>
                                </div>
                                <div class="col-4 text-center">
                                    <select id="given-status">
                                        <option>Alive</option>
                                        <option>Sick</option>
                                        <option>Dead</option>
                                        <option>Fallen</option>
                                    </select>
                                </div>
                                <div class="col-2"></div>
                            </div>

                            <br>

                            <div class="row">
                                <div class="col-2"></div>
                                <div class="col-1 text-center">
                                    <i class="fas fa-circle-info" style="margin-top: 50%;" data-bs-toggle="tooltip"
                                        data-bs-placement="top"
                                        data-bs-title="Which of the 3 size classes based on diameter the tree fits into."></i>
                                </div>
                                <div class="col-3 text-center">
                                    <h4>
                                        Size</h4>
                                </div>
                                <div class="col-4 text-center">
                                    <select id="given-size-class">
                                        <option>Small</option>
                                        <option>Medium</option>
                                        <option>Big</option>
                                    </select>
                                </div>
                                <div class="col-2"></div>
                            </div>

                            <br>

                            <div class="row">
                                <div class="col-2"></div>
                                <div class="col-1 text-center">
                                    <i class="fas fa-circle-info" style="margin-top: 50%;" data-bs-toggle="tooltip"
                                        data-bs-placement="top"
                                        data-bs-title="The diameter in centimeters from breast height."></i>
                                </div>
                                <div class="col-3 text-center">
                                    <h4>
                                        DBH</h4>
                                </div>
                                <div class="col-4 text-center">
                                    <input type="number" id="given-dbh">
                                </div>
                                <div class="col-2"></div>
                            </div>

                            <br>


                            <div class="row">
                                <div class="col-2"></div>
                                <div class="col-1 text-center">
                                    <i class="fas fa-circle-info" style="margin-top: 50%;" data-bs-toggle="tooltip"
                                        data-bs-placement="top" data-bs-title="1: Confident this is the same tree as last census,
                                        2: Probably the same tree as last census,
                                        3: Likely a new tree,
                                        4: Definitely an old tree but it can't be matched OR the tag is not registered for the previous census,
                                        5: A Lost tree."></i>
                                </div>
                                <div class="col-3 text-center">
                                    <h4>
                                        Match #</h4>
                                </div>
                                <div class="col-4 text-center">
                                    <select id="given-match-num">
                                        <option>1</option>
                                        <option>2</option>
                                        <option>3</option>
                                        <option>4</option>
                                        <option>5</option>
                                    </select>
                                </div>
                                <div class="col-2"></div>
                            </div>

                            <br>

                            <div class="row">
                                <div class="col-2"></div>
                                <div class="col-1 text-center">
                                    <i class="fas fa-circle-info" style="margin-top: 50%;" data-bs-toggle="tooltip"
                                        data-bs-placement="top"
                                        data-bs-title="Other important notes to mention about the tree or the info entered above."></i>
                                </div>
                                <div class="col-3 text-center">
                                    <h4 style="margin-bottom: 4%;">
                                        Comments</h4>
                                </div>
                                <div class="col-4 text-center">
                                    <input style="text-align: left; margin-bottom: 4%;" id="given-comment">
                                </div>
                                <div class="col-2"></div>
                            </div>


                        </div>
                    </div>


                    <div class="modal-footer justify-content-between">
                        <h3 id="submission-notice" style="visibility: hidden;">Please fill out all the form
                            entirely before submission!</h3>
                        <button type="button" class="btn" id="pop-up-update"
                            onclick="confirmUpdate(); closeModal()">Confirm Update</button>

                    </div>

                </div>
            </div>
        </div>



        <!--Line break-->
        <div class="row">
            <div class="col-xs-12 bs-linebreak">
            </div>
        </div>
        <br>



        <!--THE SURVEY ITSELF!-->

        <!--Choosing a plot-->
        <div class="row">
            <div class="col"></div>
            <div class="col-auto">
                <h2>Select a plot:</h2>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="col"></div>
            <div class="col-auto">
                <select name="plot" id="plot-select" class="form-select" onchange="updateSurveyTable()">
                    <option value="ChosePlot">Chose a plot here</option>
                </select>
            </div>
            <div class="col"></div>
        </div>


        <!--Line Break-->
        <div class="row">
            <div class="col-xs-12 bs-linebreak">
            </div>
        </div>
        <br>


        <!--Add button part 1-->
        <div class="row" id="add-button" style="visibility: hidden;">
            <div class="col-3 "></div>
            <div class="col-6 text-center">
                <button id="add-new-tree-button" data-bs-toggle="modal" data-bs-target="#pop-up"
                    onclick="createNewTree()">
                    Add new tree
                </button>
            </div>
            <div class="col-3"></div>
        </div>


        <!--The interactive table-->
        <div class="row" id="survey-table" style="visibility: hidden;">
            <div class="col-1"></div>
            <div class="col-10">
                <table class="table" style="overflow-x: scroll;">
                    <thead>
                        <tr>
                            <th class="text-center" scope="col" style="width: 16%; min-width: 150px;">View & Update</th>
                            <th class="text-center" scope="col">Recent Tag #</th>
                            <th class="text-center" scope="col">Size Class</th>
                            <th class="text-center" scope="col">Species</th>
                        </tr>
                    </thead>
                    <tbody id="table-body" class="text-center">

                    </tbody>
                </table>
            </div>
            <div class="col-1"></div>
        </div>
        <br>
        <br>

        <div class="row" id="gray-warning" style="visibility: hidden;">
            <div class="col-2 "></div>
            <div class="col-8 text-center">
                <h5 id="gray-note">Note: a gray background for a tree entry means it's already been updated for the
                    current census</h5>
            </div>
            <div class="col-2"></div>
        </div>
        <br>

        <!--Line Break-->
        <div class="row">
            <div class="col-xs-12 bs-linebreak">
            </div>
        </div>
        <br>

    </div>


    <!--Citing used assets-->
    <footer class="mt-auto">
        Tree by redemption_art from <a href="https://thenounproject.com/icon/tree-7359759/" target="_blank"
            title="Tree Icons" id="used-asset-link" style="color: white;">Noun
            Project</a> (CC BY 3.0)
    </footer>




</body>

</html>